## SIR модель
Sir модель -- одна из простейших компартментных моделей распространения эпидемий. Все особи популяции в данной модели делятся на группы (компартменты).
В sir модели особи поделены на три группы:

1. S(t) - подверженные заболеванию особи (susceptible)  
2. I(t) - заражённые особи (infected)
3. R(t) - переболевшие (resistant)

>[!caption|center]
>![[SIR-model.png]]
> Диаграмма эволюции особи популяции в SIR-модели

Sir модель рассматривает замкнутую популяцию, в которой не происходят процессы рождаемости и смертности. Поэтому будет верно следующее уравнение:

$$
S + I + R = N,
$$
где N - общее число особей популяции.

## SEIR модель

Во многих болезнях есть инкубационный период, во время которого особь заражена, но не пока заразна. Можно учесть эту задержку между моментом заражения и моментом, когда особь становится заразной, в модели SIR, добавив дополнительную группу E (exposed). Соответственно немного изменится диаграмма эволюции особи, а именно добавятся связи S→E и E→I.

>[!caption|center]
>![[Flow-chart-of-the-SEIR-model-SEIR-model-is-another-conventional-prediction-model-It-is.ppm.png]]
> Диаграмма эволюции особи популяции в SEIR-модели

На схеме показаны следующие коэффициенты:
- $\beta$ - коэффициент заражения (вероятность того, что контакт между восприимчивым и заражённым приводит к новому заражению (переход S → E);
- $\sigma$ - коэффициент инкубационного перехода (вероятность того, что зараженный индивид становится заразным (переход E → I));
- $\gamma$ - коэффициент выздоровления (вероятность того, что заражённый индивид выздоравливает (переход I → R).

В замкнутой популяции, где отсутствуют процессы рождения и смерти, модель SEIR принимает следующий вид:

$$
\begin{aligned}
\frac{dS}{dt} &= -\frac{\beta SI}{N}, \\
\frac{dE}{dt} &= \frac{\beta SI}{N} - \sigma E, \\
\frac{dI}{dt} &= \sigma E - \gamma I, \\
\frac{dR}{dt} &= \gamma I,
\end{aligned}
$$
где $N = S + E + I + R$ - вся популяция.

## SEIRS модель

Модель SEIR предполагает, что после выздоровления особь приобретает пожизненный иммунитет к заболеванию. Однако для многих инфекций иммунитет после перенесённого заболевания со временем ослабевает. В этом случае используется модель SEIRS, которая допускает возврат выздоровевших особей в восприимчивое состояние. Параметр $\xi$ в этой модели характеризует вероятность потери иммунитета, то есть вероятность того, что выздоровевший индивид (R) со временем возвращается в категорию восприимчивых (S).

Если приток восприимчивых в популяцию достаточно велик, система в установившемся состоянии переходит в эндемическое равновесие (устойчивое состояние системы, в котором инфекция сохраняется на постоянном уровне: не исчезает и не угасает), сопровождаемое затухающими колебаниями численности заболевших.

Система дифференциальных уравнений для модели SEIRS имеет вид:

$$
\begin{aligned}
\frac{dS}{dt} &= -\frac{\beta S I}{N} + \xi R, \\
\frac{dE}{dt} &= \frac{\beta S I}{N} - \sigma E, \\
\frac{dI}{dt} &= \sigma E - \gamma I, \\
\frac{dR}{dt} &= \gamma I - \xi, R
\end{aligned}
$$

где $N = S + E + I + R$ - вся популяция.

Также рассмотрим схему, на которой показано, как индивиды переходят между компартментами модели. Пунктирная стрелка показывает, как модель SEIR превращается в SEIRS (Susceptible – Exposed – Infectious – Recovered – Susceptible):

>[!caption|center]
>![[SEIR-SEIRS.png]]
> Диаграмма эволюции особи популяции в SEIRS-модели

## Метод NIMFA

Классические модели SIR/SEIR описывают усреднённую динамику инфекционного процесса во всей популяции и не учитывают структуру взаимодействий между её элементами. В реальных же системах — например, в сетях Интернета вещей (IoT) — заражение распространяется по связям между конкретными устройствами, аналогично тому, как в популяции особи контактируют не со всеми, а только с соседями.

Для учёта этой сетевой структуры используется метод NIMFA (N-Intertwined Mean-Field Approximation). В нём каждая особь из классической модели рассматривается как отдельный узел графа, а вероятность её заражения определяется степенью заражённости соседних узлов.

Сеть IoT представляется как неориентированный граф $G(V, E)$, где $V$ — множество узлов (устройств), $E$ — множество связей. Матрица смежности $A = [a_{ij}]$ отражает наличие соединений: $a_{ij} = 1$, если устройства i и j связаны, иначе 0.

Метод NIMFA описывает вероятности заражения $p_i(t)$ для каждого узла $i$ во времени с помощью системы дифференциальных уравнений:
$$
\frac{dp_i}{dt} = -\delta p_i(t) + (1 - p_i(t))\beta \sum_{j=1}^{N} a_{ij} p_j(t).
$$

где:
- $p_i(t)$ — вероятность того, что узел i заражён в момент времени t;
- $\beta$ — коэффициент заражения (интенсивность передачи между связанными узлами);
- $\delta$ — коэффициент восстановления (скорость устранения заражения);
- $a_{ij}$ — элемент матрицы смежности, определяющий связь между узлами i и j.

Таким образом, вероятность заражения конкретного узла зависит от состояния его соседей и от параметров распространения вредоносного ПО.

## Модель SEIRS-NIMFA

Модель SEIRS-NIMFA объединяет принципы SEIRS-модели и сетевого приближения NIMFA, что позволяет описывать распространение заражения в гетерогенных системах, где каждое устройство В отличие от усреднённых моделей, здесь рассматривается **индивидуальное состояние каждого узла**.

Для каждого устройства $i$ вводятся вероятности нахождения в четырёх состояниях:

$$
x_i(t),\; w_i(t),\; y_i(t),\; z_i(t),
$$

соответствующие компартментам S, E, I, R, при этом выполняется нормировка:

$$
x_i(t) + w_i(t) + y_i(t) + z_i(t) = 1.
$$
> [!caption|center]
> ![[42400_2024_310_Fig2_HTML.png.webp]]
> Схема переходов между состояниями в модели SEIRS-NIMFA


Переходы между состояниями описываются независимыми пуассоновскими процессами со следующими параметрами:

- $\beta_i$ — вероятность заражения при контакте с инфицированным соседом (S → E);
- $\alpha_i$ — вероятность перехода из экспонированного в заразное состояние (E → I);
- $\delta_i$ — вероятность выздоровления (I → R);
- $\gamma_i$ — вероятность потери иммунитета и возвращения в восприимчивое состояние (R → S).

### Скорость заражения

В сетевой постановке интенсивность заражения узла $i$ зависит от вероятности заражённости его соседей и выражается как:

$$
b_i(t) = \beta_i \sum_{j=1}^{N} a_{ij} y_j(t),
$$
где $a_{ij}$ — элемент матрицы смежности, показывающий наличие связи между узлами.

### Уравнения SEIRS-NIMFA

Динамика вероятностей описывается системой дифференциальных уравнений:

$$
\begin{aligned}
\frac{dx_i}{dt} &= -b_i(t)x_i + \gamma_i z_i,\\
\frac{dw_i}{dt} &= b_i(t)x_i - \alpha_i w_i, \\
\frac{dy_i}{dt} &= \alpha_i w_i - \delta_i y_i,\\
\frac{dz_i}{dt} &= \delta_i y_i - \gamma_i z_i.
\end{aligned}
$$
  
Эта система моделирует изменения вероятностей для каждого узла во времени, учитывая топологию графа и параметры переходов. Для численного решения используется метод Эйлера при заданных начальных условиях.